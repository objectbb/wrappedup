(function() {
    angular.module('wrappedup.app', ['ui.bootstrap']).
    config(['$httpProvider', function($httpProvider) {
        // Intercept POST requests, convert to standard form encoding
        $httpProvider.defaults.headers.post["Content-Type"] = "application/x-www-form-urlencoded";

        $httpProvider.defaults.transformRequest.unshift(function(data, headersGetter) {
            var key, result = [];
            for (key in data) {
                if (data.hasOwnProperty(key)) {
                    result.push(encodeURIComponent(key) + "=" + encodeURIComponent(data[key]));
                }
            }
            return result.join("&");
        })
    }]);
}());
(function() {
    angular.module('wrappedup.app').controller('DatepickerDemoCtrl', function($scope, $modal, $log) {
        $scope.dt = new Date();
        $scope.minDate = new Date();
        $scope.open = function() {
            var modalInstance = $modal.open({
                animation: $scope.animationsEnabled,
                templateUrl: 'signup.html',
                controller: 'ModalInstanceCtrl',
                size: 'lg',
                resolve: {
                    items: function() {
                        return $scope.dt;
                    }
                }
            });
           
            modalInstance.result.then(function(selectedItem) {
                $scope.selected = selectedItem;
            }, function() {
                $log.info('Modal dismissed at: ' + new Date());
            });
        };



   $scope.schedule = function() {
            var modalInstance = $modal.open({
                animation: $scope.animationsEnabled,
                templateUrl: 'schedule.html',
                controller: 'ModalInstanceCtrl',
                size: 'lg',
                resolve: {
                    items: function() {
                        return $scope.request;
                    }
                }
            });
           
            modalInstance.result.then(function(selectedItem) {
                $scope.selected = selectedItem;
            }, function() {
                $log.info('Modal dismissed at: ' + new Date());
            });
        };



    });
})();
(function() {
    angular.module('wrappedup.app').controller('ModalInstanceCtrl',['$scope', '$modalInstance', 'items', 'RequestService', 
      function($scope, $modalInstance, items, RequestService) {
        $scope.items = items;

        $scope.ok = function() {
            $modalInstance.close($scope.selected.item);
        };
        $scope.cancel = function() {
            $modalInstance.dismiss('cancel'); 
        };

        $scope.clear = function() {
           $scope.request = null;
        };
        
        $scope.send = function() {
           RequestService.send($scope.request);
        };

    }]);
})();


(function() {
    angular.module('wrappedup.app').service('RequestService', ['$http', function($http) {

        return {
            send: function(data) {
                //var urlrequest = "http://peaceful-lowlands-1646.herokuapp.com/web";

                var urlrequest = "http://localhost:5000/web";
                return $http.post(urlrequest,{Body:  JSON.stringify(data)}).success(function(data){
                    return data;
                }).error(function(err){
                    alert(JSON.stringify(err));
                });
            }
        }
    }]);
})();